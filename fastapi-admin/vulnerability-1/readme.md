# Information Disclosure Vulnerability in FastapiAdmin

> **Software and Affected Version:** [FastapiAdmin](https://github.com/fastapiadmin/FastapiAdmin) ≤ 2.2.0

## Vulnerability Files

-   `/backend/app/plugin/init_app.py`

## Description

An information disclosure vulnerability in [FastapiAdmin](https://github.com/fastapiadmin/FastapiAdmin) ≤ 2.2.0 located in `/backend/app/plugin/init_app.py` allows unauthenticated users to access the OpenAPI specification (openapi.json) and the API documentation pages (e.g., /api/v1/docs, /api/v1/redoc) because the custom documentation endpoints are exposed without any authentication or authorization. This exposure allows attackers enumerate endpoints, parameters, models and other metadata that can facilitate targeted attacks or leakage of sensitive implementation details. Mitigation is to restrict or disable documentation in production, require authentication/authorization for docs and openapi routes, or serve them only on trusted internal networks.

## Code Analysis

The developers only implemented configurable API documentation paths, but did not implement authentication or authorization for accessing the API documentation.

```py
def reset_api_docs(app: FastAPI) -> None:
    """
    使用本地静态资源自定义 API 文档页面（Swagger UI 与 ReDoc）。

    参数:
    - app (FastAPI): FastAPI 应用实例。

    返回:
    - None
    """

    @app.get(settings.DOCS_URL, include_in_schema=False)
    async def custom_swagger_ui_html() -> HTMLResponse:
        return get_swagger_ui_html(
            openapi_url=str(app.root_path) + str(app.openapi_url),
            title=app.title + " - Swagger UI",
            oauth2_redirect_url=app.swagger_ui_oauth2_redirect_url,
            swagger_js_url=settings.SWAGGER_JS_URL,
            swagger_css_url=settings.SWAGGER_CSS_URL,
            swagger_favicon_url=settings.FAVICON_URL,
        )

    @app.get(str(app.swagger_ui_oauth2_redirect_url), include_in_schema=False)
    async def swagger_ui_redirect():
        return get_swagger_ui_oauth2_redirect_html()

    @app.get(settings.REDOC_URL, include_in_schema=False)
    async def custom_redoc_html():
        return get_redoc_html(
            openapi_url=str(app.root_path) + str(app.openapi_url),
            title=app.title + " - ReDoc",
            redoc_js_url=settings.REDOC_JS_URL,
            redoc_favicon_url=settings.FAVICON_URL,
        )
```

## Proof of Concept

You can access `/api/v1/docs`, `/api/v1/redoc`, or `/api/v1/openapi.json` without authentication or authorization.

![](./assets/apidoc-1.png)

![](./assets/apidoc-2.png)
