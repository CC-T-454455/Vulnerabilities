# Stored XSS Vulnerability in HotGo

> **Software and Affected Version:** [HotGo](https://github.com/bufanyun/hotgo) ≤ v2.0

## Affected Files

-   `/web/src/views/addons/hgexample/table/view.vue`

## Description

A stored Cross-Site Scripting (XSS) vulnerability exists in [HotGo](https://github.com/bufanyun/hotgo) ≤ v2.0 at the table detail functionality, where the `/admin/hgexample/table/edit` endpoint accepts user-supplied `content` field without sanitization or validation, stores it directly in the database, and the Vue.js frontend renders this content using `v-html` without sanitization or validation. As a result, authenticated attackers can inject arbitrary JavaScript that executes in the browsers of users viewing the table detail, potentially leading to session hijacking, credential theft, or malicious actions performed on behalf of victims. Mitigations include implementing HTML sanitization using libraries like DOMPurify, avoiding `v-html` in favor of safe Vue.js rendering, implementing Content Security Policy (CSP) headers, encoding output context-appropriately, and validating input against a whitelist of allowed HTML tags and attributes.

## Code Analysis

In `/web/src/views/addons/hgexample/table/view.vue`:

```vue
<template>
    <div>
        <div class="n-layout-page-header">
            <n-card :bordered="false" title="基础详情"> 基础详情，有时也用于显示只读信息。 </n-card>
        </div>

        <!-- ... -->

        <n-card :bordered="false" class="proCard mt-4" size="small" :segmented="{ content: true }">
            <n-descriptions label-placement="top" title="内容" class="py-2" :column="1">
                <n-descriptions-item><span v-html="formValue.content"></span></n-descriptions-item>
            </n-descriptions>
        </n-card>

        <!-- ... -->
    </div>
</template>
```

The `v-html` directive is used to render the table detail. According to the [Vue.js documentation](https://vuejs.org/api/built-in-directives#v-html), Vue template syntax will not be processed and the inserted content is not sanitized.

## Proof of Concept

Create a example table with content `<img src=x onerror='alert(1)' />` using the following request:

![](./assets/xss-1.png)

Confirm that the example table is successfully created with the XSS payload:

![](./assets/xss-2.png)

View table detail on the client side, causing a pop-up window:

![](./assets/xss-3.png)
